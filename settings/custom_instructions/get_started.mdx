---
title: "Custom Instructions"
description: "Create and manage your own review rules in Refacto."
---

Learn how to define and apply **custom AI review rules** using YAML in Refacto.

<Steps>
  <Step title="Open Custom Instructions" icon="compass">
    - Navigate to **Refacto → Settings → Custom Instructions**.
    - You’ll see two tabs:
      - **PR Review** – controls how the AI analyzes pull requests.
      - **Custom Instructions** – lets you define rules and coding standards using YAML.
  </Step>
  <Step title="Choose How to Start" icon="file-plus">
    You can begin in two ways:

    - **Load Example & Get Started** – creates a sample YAML with one org rule and two repo rules.
    - **Start from Scratch** – starts with an empty config.
  </Step>
  <Step title="Edit the Template" icon="pencil">
    When you load the example, a YAML editor opens with three prefilled blocks (1 org, 2 repo-specific).

    You can click **Add Repository** to insert a new block.

    | Field              | Description                 | Example                              |
    | ------------------ | --------------------------- | ------------------------------------ |
    | `match.paths`      | Regex to match file paths   | `src/java*`                          |
    | `match.extensions` | File extensions to include  | `.ts, .js`                           |
    | `instructions`     | The actual review rule text | `"All PRs must include unit tests."` |

    <Note>
      Only the content under instructions counts toward the 500-character limit per block.
    </Note>
  </Step>
  <Step title="Submit for Review" icon="upload">
    Below the editor, you’ll find a summary table showing:

    - Character usage per block
    - Status (No Status, Approved, In Review, Rejected)
    - Rejection reason (if any)

    Select blocks to send for approval and click **Submit & Apply**.

    | Status    | Meaning                                      |
    | --------- | -------------------------------------------- |
    | No status | Not yet submitted                            |
    | In Review | Under validation (usually a few days)        |
    | Approved  | Instructions are active                      |
    | Rejected  | Invalid or security violation (reason shown) |
  </Step>
  <Step title="Verify Rules in PRs" icon="eye">
    When Refacto reviews a PR, it posts a summary comment with:

    - **Applied Instructions** – which rules were used
    - **Unapplied Instructions** – skipped rules and reasons (e.g., repo mismatch)

    <Note>
      Once approved, your rules automatically apply to all matching PRs across the organization.
    </Note>
  </Step>
  <Step title="Update or Resubmit" icon="arrows-rotate-reverse">
    You’ll need to update your YAML when:

    - Repo structure or coding standards change
    - A submission was previously rejected

    To resubmit:

    1. Open your existing YAML config
    2. Edit only the changed block(s)
    3. Select updated or rejected blocks
    4. Click **Submit for Review**

    Approved blocks stay active until the new version is approved.\
    Rejected blocks display a “Rejection Reason”.

    <Note>
      Avoid flagged words like “ignore above”, “override”, or “bypass”. Keep YAML syntax valid with 2-space indents.
    </Note>
  </Step>
  <Step title="Limits and Validation" icon="shield">
    **Character Limits**

    - 500 characters per block
    - 4000 characters total per YAML

    **YAML Format Rules**

    - YAML 1.2 compliant
    - 2-space indentation, no tabs
    - Allowed root fields: `version`, `language`, `org`, `repos`

    **Validation Requirements**

    - At least one instruction required
    - Repo names: alphanumeric, `_` or `-` only
    - Up to 10 repos, 20 items per `match` array

    **Security Checks**

    - Avoid terms like “ignore above”, “override”, “forget previous”
    - Don’t include text that alters AI behavior or review logic

    <Note>
      These safeguards ensure consistent and safe PR reviews.
    </Note>
  </Step>
  <Step title="Preview and Verify" icon="search">
    Use **Show Preview** in the Custom Instructions tab to confirm:

    - YAML structure validity
    - Which rules apply to which repositories
  </Step>
  <Step title="FAQs" icon="question">
    **My YAML shows “Rejected.”**\
    → The block failed validation. Check “Rejection Reason” and fix the YAML.

    **My rules are approved but not applied.**\
    → Ensure `match.paths` or `match.extensions` match your PR’s changed files.

    **Can I define org-wide and repo-specific rules?**\
    → Yes. Org rules apply globally; repo rules add project-level specificity.

    **Do I need to resubmit all blocks?**\
    → No. Only resubmit updated or rejected ones.

    **Are YAML comments counted?**\
    → No, only text inside `instructions:` counts.

    **Can I use multiple file patterns?**\
    → Yes — up to 20 items per `paths:` or `extensions:` array.
  </Step>
</Steps>